!function t(e,r,n){function o(a,c){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return o(r||t)},l,l.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){function n(t){if(t.seed){var e=a(t);"yes"===e.hideUi?o(e):(function(){let{input:t,created:e}=s({id:"upload-input",tag:"input"});if(!e)return;t.type="file",t.setAttribute("accept","image/*"),document.body.appendChild(t),t.addEventListener("change",function(){if(t.files.length<1)return;const e=t.files[0];M.addToRoute({srcImgUrl:URL.createObjectURL(e)})})}(),u({id:"rerun-button",text:"Run it again!",onClick:c}),u({id:"download-button",text:"Download the (first) generated image",onClick:v}),u({id:"random-image-button",text:"Get a random source image from the Internet Archive",onClick:l}),e.srcImgUrl&&o(e))}else M.addToRoute({seed:(new Date).toISOString()})}function o(t){function e(e){return Object.assign({},e,{probable:t.probable})}function r(t){t(),requestAnimationFrame(r)}function n(t){C.innerHTML="";var e=d(o)(t.currentTarget);c.forEach(e)}function o(t,e,r){var n=`target-canvas-${r}`,o=document.getElementById(n);o||((o=document.createElement("canvas")).setAttribute("id",n),C.appendChild(o));var i=Object.assign({},e,{img:t,targetCanvas:o,grayscale:"yes"===e.grayscale,showBase:"yes"===e.showBase});f&&f.destroy&&f.destroy(),(f=new A[e.renderer](i)).start()}var i=g(t.seed);t.probable=y({random:i});let c;c=t.runs?JSON.parse(decodeURIComponent(t.runs)).map(a).map(e):[t],function(t){var e=t?"remove":"add";document.getElementById("source-canvas").classList[e]("hidden")}("yes"===t.displaySrcImage),"yes"===t.useCamera?(console.log("loadCameraFrame!"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(t){function e(){o(i,n,0)}var n=c[0],i=document.getElementById("camera-buffer");i.height=n.videoSize,i.width=n.videoSize,i.srcObject=t,i.play(),n.cameraRefreshInterval?setInterval(e,n.cameraRefreshInterval):r(e)}).catch(function(t){console.log("An error occurred! "+t)})):function(){var e=new Image;e.crossOrigin="Anonymous",e.addEventListener("load",n),e.src=t.srcImgUrl}()}function i(t,e,r,n,o){h(o)}function a(t){return Object.assign({},O,t)}function c(){M.addToRoute({seed:(new Date).toISOString()})}function u({id:t,text:e,onClick:r}){let{button:n,created:o}=s({id:t,tag:"button"});o&&(n.textContent=e,n.addEventListener("click",r),document.body.appendChild(n))}function s({id:t,tag:e}){let r=document.getElementById(t),n=!1;return r||(n=!0,(r=document.createElement(e)).id=t),{[e]:r,created:n}}function l(){var t=j.roll();m({request:b,proxyBaseURL:"https://jimkang.com/internet-archive",collection:t.collection,query:t.query,mediatype:"image",fileExtensions:["jpg","jpeg","png"],minimumSize:1e5,maximumSize:5e6},x(function({url:t,collection:e,title:r,detailsURL:n}){console.log("Image URL:",t,"Collection:",e,"Title:",r,"details:",n),M.addToRoute({srcImgUrl:t})},h))}var f,h=t("handle-error-web"),p=t("route-state"),d=t("lodash.curry"),y=t("probable").createProbable,g=t("seedrandom"),v=t("./download-from-target-canvas"),m=t("random-internet-archive"),b=t("basic-browser-request"),w=t("good-ia-source-image-probable-def"),x=t("standard-bail")(),j=y().createTableFromSizes(w),O={srcImgUrl:"data/fish.jpg",useCamera:"no",cameraRefreshInterval:1e3,videoSize:640,displaySrcImage:"yes",quant:16,grayscale:"yes",recolorMode:"random",renderer:"replacer",showBase:"no",opacityPercentOverBase:50,numberOfRetriesToAvoidSingleColor:5,minimumValueDifference:0,tolerance:10,maxLength:2048,useWholeNumberScaleUpFactor:"yes",hideUi:"no",swapColorPerFrame:"no",swapColorPerPixel:"no",swapColorPerAlternateRow:"no"},M=p({followRoute:n,windowObject:window}),A={replacer:t("./replacer"),linefiller:t("./linefiller"),igniter:t("./igniter")},C=document.getElementById("target-canvases-container");window.onerror=i,M.routeFromHash()},{"./download-from-target-canvas":2,"./igniter":4,"./linefiller":5,"./replacer":38,"basic-browser-request":7,"good-ia-source-image-probable-def":12,"handle-error-web":13,"lodash.curry":16,probable:19,"random-internet-archive":26,"route-state":28,seedrandom:29,"standard-bail":37}],2:[function(t,e,r){function n(t){window.location.href=window.URL.createObjectURL(t)}e.exports=function(){document.getElementById("target-canvas-0").toBlob(n)}},{}],3:[function(t,e,r){var n=t("probable"),o=t("d3-color").hsl;e.exports=function({originalString:t,newForOld:e,recolorMode:r="random",rgbaToString:i}){if("none"===r)return t;let a=e[t];if(!a){if("random"===r)a=i([n.roll(256),n.roll(256),n.roll(256),255]);else if("shiftHue"===r){let e=o(t);e.h=n.roll(360),a=e.toString()}e[t]=a}return a}},{"d3-color":11,probable:19}],4:[function(t,e,r){var n=t("probable");class o{constructor(t){this.img=t.img,this.targetCanvas=t.targetCanvas,this.targetCtx=this.targetCanvas.getContext("2d"),this.showBase=t.showBase,this.opacityPercentOverBase=t.opacityPercentOverBase,this.boundDrawFrame=this.drawFrame.bind(this),this.frameCount=0,this.swapColorPerFrame="yes"===t.swapColorPerFrame,this.swapColorPerPixel="yes"===t.swapColorPerPixel,this.swapColorPerAlternateRow="yes"===t.swapColorPerAlternateRow,this.lastAnimationRequestId,this.shuffleSwappedColors()}destroy(){this.lastAnimationRequestId&&window.cancelAnimationFrame(this.lastAnimationRequestId)}start(){this.imgData=this.initCanvases(),this.lastAnimationRequestId=requestAnimationFrame(this.boundDrawFrame)}initCanvases(){var t=this.img,e=document.getElementById("source-canvas"),r=e.getContext("2d");return e.width=t.width,e.height=t.height,this.outputBuffer=new Uint8ClampedArray(t.width*t.height*4),r.drawImage(t,0,0,t.width,t.height),this.targetCanvas.width=t.width,this.targetCanvas.height=t.height,r.getImageData(0,0,t.width,t.height)}drawFrame(){this.swapColorPerFrame&&this.shuffleSwappedColors();for(var t=0;t<this.imgData.height;++t)for(let e=0;e<this.imgData.width;e++){const r=this.imgData.width*t+e;let n=(r+this.frameCount)%(this.imgData.width*this.imgData.height);t%2==0&&(this.swapColorPerPixelAlternateRow&&this.shuffleSwappedColors(),n=(r-this.frameCount)%(this.imgData.width*this.imgData.height)),this.swapColorPerPixel&&this.shuffleSwappedColors();for(let e=0;e<4;++e){const o=4*r+e;let i=4*n+e;t%2==0&&(e===this.swapColorIndex1?i=4*n+this.swapColorIndex2:e===this.swapColorIndex2&&(i=4*n+this.swapColorIndex2)),this.outputBuffer[i]=this.imgData.data[o]}}this.targetCtx.putImageData(new ImageData(this.outputBuffer,this.imgData.width,this.imgData.height),0,0),this.frameCount++,this.lastAnimationRequestId=requestAnimationFrame(this.boundDrawFrame)}shuffleSwappedColors(){this.swapColorIndex1=n.roll(3),this.swapColorIndex2=n.roll(3)}}e.exports=o},{probable:19}],5:[function(t,e,r){function n(t){return`rgba(${t.slice(0,3).join(", ")}, ${t[3]/255})`}var o=t("./getReplacementColor");class i{constructor(t){this.quantizationFactor=t.quant,this.grayscale=t.grayscale,this.recolorMode=t.recolorMode,this.img=t.img,this.targetCanvas=t.targetCanvas,this.showBase=t.showBase,this.opacityPercentOverBase=t.opacityPercentOverBase,this.numberOfRetriesToAvoidSingleColor=+t.numberOfRetriesToAvoidSingleColor,this.minimumValueDifference=+t.minimumValueDifference,this.tolerance=+t.tolerance}start(){const t=this.drawSrcCanvas();this.recolor({imgData:t})}drawSrcCanvas(){var t=this.img,e=document.getElementById("source-canvas"),r=e.getContext("2d");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0,t.width,t.height),r.getImageData(0,0,t.width,t.height)}recolor({imgData:t}){this.targetCanvas.width=t.width,this.targetCanvas.height=t.height;const e=this.targetCanvas.getContext("2d");var r={};for(let i=0;i<t.height;i++){let a=0,c=null;for(let u=0;u<t.width;u++){const s=this.getImgDataRgba({imgData:t,x:u,y:i});if(null===c)c=s;else{((function(t,e){let r=0;for(let n=0;n<4;n++)r+=Math.abs(e[n]-t[n]);return r/4})(c,s)>this.tolerance||u===t.width-1)&&(e.beginPath(),e.moveTo(a,i),e.lineTo(u,i),e.strokeStyle=o({originalString:n(c),newForOld:r,recolorMode:this.recolorMode,rgbaToString:n}),e.stroke(),a=u,c=null)}}}}getImgDataRgba({imgData:t,x:e,y:r}){const n=4*(t.width*r+e);return[0,1,2,3].map(function(e){return t.data[n+e]})}}e.exports=i},{"./getReplacementColor":3}],6:[function(t,e,r){(function(t){!function(r){"use strict";var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=function(e,r){if(r=r||function(){},!n(e)){var o=new Error("First argument to waterfall must be an array of functions");return r(o)}if(!e.length)return r();var i=function(e){return function(n){if(n)r.apply(null,arguments),r=function(){};else{var o=Array.prototype.slice.call(arguments,1),a=e.next();a?o.push(i(a)):o.push(r),function(e){"function"==typeof setImmediate?setImmediate(e):void 0!==t&&t.nextTick?t.nextTick(e):setTimeout(e,0)}(function(){e.apply(null,o)})}}};i(function(t){var e=function(r){var n=function(){return t.length&&t[r].apply(null,arguments),n.next()};return n.next=function(){return r<t.length-1?e(r+1):null},n};return e(0)}(e))()};"undefined"!=typeof define&&define.amd?define([],function(){return o}):void 0!==e&&e.exports?e.exports=o:r.asyncWaterfall=o}(this)}).call(this,t("_process"))},{_process:20}],7:[function(t,e,r){if("object"==typeof e&&"object"==typeof e.exports){var n={makeRequest:function(t,e){function r(){i.abort(),clearTimeout(c),e()}function n(){3===i.readyState&&(t.onData(this.responseText.substr(u)),u=this.responseText.length)}var o=t.json||"application/json"===t.mimeType,i=new XMLHttpRequest;if(i.open(t.method,t.url),t.mimeType&&i.setRequestHeader("content-type",t.mimeType),o&&i.setRequestHeader("accept","application/json"),"object"==typeof t.headers)for(var a in t.headers)i.setRequestHeader(a,t.headers[a]);t.binary&&(i.responseType="arraybuffer"),o&&"object"==typeof t.body&&(t.body=JSON.stringify(t.body));var c=null;i.onload=function(){clearTimeout(c);var r={statusCode:this.status,statusMessage:i.statusText,responseURL:i.responseURL,rawResponse:i.response,xhr:i};if(t.binary)e(null,r,i.response);else{var n=this.responseText;if(o)try{n=JSON.parse(n)}catch(t){r.jsonParseError=t}e(null,r,n)}};var u=0;return t.onData&&(i.onreadystatechange=n),i.onerror=function(){var t=new Error("There is a problem with the network.");t.name="XHR network error",e(t)},i.send(t.formData||t.body),t.timeLimit>0&&(c=setTimeout(r,t.timeLimit)),{url:t.url,cancelRequest:r}}};e.exports=n.makeRequest}},{}],8:[function(t,e,r){},{}],9:[function(t,e,r){(function(t){e.exports=function(){var e,r,n,o=arguments.length;if(!(o>0))throw new Error("No callback provided to callNextTick.");e=arguments[0],r=new Array(o-1);for(var i=1;i<o;++i)r[i-1]=arguments[i];n=function(t,e){return function(){t.apply(t,e)}}(e,r),t.nextTick(n)}}).call(this,t("_process"))},{_process:20}],10:[function(t,e,r){e.exports=function({channel:t,properties:e,noErrorParam:r}){function n(t,e,r){t?r(t):o(e,r)}function o(r,n){function o(e){if(Array.isArray(e)&&2===e.length){let n=e[0];t[e[1]]="function"==typeof n?n(r):r[e[0]]}else t[e]=r[e]}r&&e.forEach(o),n(null,t)}return r?o:n}},{}],11:[function(t,e,r){!function(t,n){"object"==typeof r&&void 0!==e?n(r):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function e(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function r(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function n(){}function o(t){var e;return t=(t+"").trim().toLowerCase(),(e=R.exec(t))?(e=parseInt(e[1],16),new s(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=S.exec(t))?i(parseInt(e[1],16)):(e=D.exec(t))?new s(e[1],e[2],e[3],1):(e=T.exec(t))?new s(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=I.exec(t))?a(e[1],e[2],e[3],e[4]):(e=E.exec(t))?a(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=N.exec(t))?f(e[1],e[2]/100,e[3]/100,1):(e=P.exec(t))?f(e[1],e[2]/100,e[3]/100,e[4]):B.hasOwnProperty(t)?i(B[t]):"transparent"===t?new s(NaN,NaN,NaN,0):null}function i(t){return new s(t>>16&255,t>>8&255,255&t,1)}function a(t,e,r,n){return n<=0&&(t=e=r=NaN),new s(t,e,r,n)}function c(t){return t instanceof n||(t=o(t)),t?(t=t.rgb(),new s(t.r,t.g,t.b,t.opacity)):new s}function u(t,e,r,n){return 1===arguments.length?c(t):new s(t,e,r,null==n?1:n)}function s(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function l(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function f(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new p(t,e,r,n)}function h(t,e,r,i){return 1===arguments.length?function(t){if(t instanceof p)return new p(t.h,t.s,t.l,t.opacity);if(t instanceof n||(t=o(t)),!t)return new p;if(t instanceof p)return t;var e=(t=t.rgb()).r/255,r=t.g/255,i=t.b/255,a=Math.min(e,r,i),c=Math.max(e,r,i),u=NaN,s=c-a,l=(c+a)/2;return s?(u=e===c?(r-i)/s+6*(r<i):r===c?(i-e)/s+2:(e-r)/s+4,s/=l<.5?c+a:2-c-a,u*=60):s=l>0&&l<1?0:u,new p(u,s,l,t.opacity)}(t):new p(t,e,r,null==i?1:i)}function p(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function d(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}function y(t){if(t instanceof v)return new v(t.l,t.a,t.b,t.opacity);if(t instanceof M){if(isNaN(t.h))return new v(t.l,0,0,t.opacity);var e=t.h*F;return new v(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof s||(t=c(t));var r,n,o=x(t.r),i=x(t.g),a=x(t.b),u=m((.2225045*o+.7168786*i+.0606169*a)/U);return o===i&&i===a?r=n=u:(r=m((.4360747*o+.3850649*i+.1430804*a)/L),n=m((.0139322*o+.0971045*i+.7141733*a)/z)),new v(116*u-16,500*(r-u),200*(u-n),t.opacity)}function g(t,e,r,n){return 1===arguments.length?y(t):new v(t,e,r,null==n?1:n)}function v(t,e,r,n){this.l=+t,this.a=+e,this.b=+r,this.opacity=+n}function m(t){return t>G?Math.pow(t,1/3):t/W+H}function b(t){return t>V?t*t*t:W*(t-H)}function w(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function x(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function j(t){if(t instanceof M)return new M(t.h,t.c,t.l,t.opacity);if(t instanceof v||(t=y(t)),0===t.a&&0===t.b)return new M(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*$;return new M(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function O(t,e,r,n){return 1===arguments.length?j(t):new M(t,e,r,null==n?1:n)}function M(t,e,r,n){this.h=+t,this.c=+e,this.l=+r,this.opacity=+n}function A(t,e,r,n){return 1===arguments.length?function(t){if(t instanceof C)return new C(t.h,t.s,t.l,t.opacity);t instanceof s||(t=c(t));var e=t.r/255,r=t.g/255,n=t.b/255,o=(et*n+Z*e-tt*r)/(et+Z-tt),i=n-o,a=(Y*(r-o)-J*i)/K,u=Math.sqrt(a*a+i*i)/(Y*o*(1-o)),l=u?Math.atan2(a,i)*$-120:NaN;return new C(l<0?l+360:l,u,o,t.opacity)}(t):new C(t,e,r,null==n?1:n)}function C(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}var _="\\s*([+-]?\\d+)\\s*",k="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",R=/^#([0-9a-f]{3})$/,S=/^#([0-9a-f]{6})$/,D=new RegExp("^rgb\\("+[_,_,_]+"\\)$"),T=new RegExp("^rgb\\("+[q,q,q]+"\\)$"),I=new RegExp("^rgba\\("+[_,_,_,k]+"\\)$"),E=new RegExp("^rgba\\("+[q,q,q,k]+"\\)$"),N=new RegExp("^hsl\\("+[k,q,q]+"\\)$"),P=new RegExp("^hsla\\("+[k,q,q,k]+"\\)$"),B={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};e(n,o,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),e(s,u,r(n,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new s(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new s(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+l(this.r)+l(this.g)+l(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),e(p,h,r(n,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new p(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new p(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,o=2*r-n;return new s(d(t>=240?t-240:t+120,o,n),d(t,o,n),d(t<120?t+240:t-120,o,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var F=Math.PI/180,$=180/Math.PI,L=.96422,U=1,z=.82521,H=4/29,V=6/29,W=3*V*V,G=V*V*V;e(v,g,r(n,{brighter:function(t){return new v(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new v(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,r=isNaN(this.b)?t:t-this.b/200;return e=L*b(e),t=U*b(t),r=z*b(r),new s(w(3.1338561*e-1.6168667*t-.4906146*r),w(-.9787684*e+1.9161415*t+.033454*r),w(.0719453*e-.2289914*t+1.4052427*r),this.opacity)}})),e(M,O,r(n,{brighter:function(t){return new M(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new M(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return y(this).rgb()}}));var X=-.14861,Q=1.78277,J=-.29227,K=-.90649,Y=1.97294,Z=Y*K,tt=Y*Q,et=Q*J-K*X;e(C,A,r(n,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new C(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new C(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*F,e=+this.l,r=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(t),o=Math.sin(t);return new s(255*(e+r*(X*n+Q*o)),255*(e+r*(J*n+K*o)),255*(e+r*(Y*n)),this.opacity)}})),t.color=o,t.rgb=u,t.hsl=h,t.lab=g,t.hcl=O,t.lch=function(t,e,r,n){return 1===arguments.length?j(t):new M(r,e,t,null==n?1:n)},t.gray=function(t,e){return new v(t,0,0,null==e?1:e)},t.cubehelix=A,Object.defineProperty(t,"__esModule",{value:!0})})},{}],12:[function(t,e,r){e.exports=[[10,{quantMin:16,quantMax:192,grayscale:"yes",showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99}],[100,{query:"animals",quantMin:16,quantMax:160,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[150,{query:"nature",quantMin:16,quantMax:128,showBaseChance:30,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes",minimumValueDifference:.4}],[200,{query:"sculpture",quantMin:16,quantMax:192,showBaseChance:30,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[100,{query:"landscape",quantMin:16,quantMax:192,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes",minimumValueDifference:.4}],[150,{query:"portrait",quantMin:16,quantMax:192,showBaseChance:80,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[100,{collection:"metropolitanmuseumofart-gallery",quantMin:32,quantMax:192,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[200,{collection:"unsplash",quantMin:32,quantMax:192,showBaseChance:40,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[70,{collection:"nasanaturalhazards",quantMin:32,quantMax:128,showBaseChance:30,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[200,{collection:"visibleearthcollection",quantMin:32,quantMax:128,showBaseChance:66,overlayOpacityMin:20,overlayOpacityMax:99,grayscale:"yes",minimumValueDifference:.4}],[50,{collection:"nasaimageofthedaygallery",quantMin:32,quantMax:144,showBaseChance:30,overlayOpacityMin:40,overlayOpacityMax:99,grayscale:"yes",minimumValueDifference:.4,numberOfRetriesToAvoidSingleColor:8}],[100,{collection:"flickrcommons",quantMin:32,quantMax:192,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}],[200,{collection:"afghanmediaresourcecenter",quantMin:16,quantMax:160,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes",minimumValueDifference:.4}],[100,{query:"drawing",quantMin:8,quantMax:192,showBaseChance:25,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"no"}],[200,{query:"etching",quantMin:8,quantMax:192,showBaseChance:25,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"no",numberOfRetriesToAvoidSingleColor:8}],[100,{query:"cat",quantMin:8,quantMax:192,showBaseChance:50,overlayOpacityMin:30,overlayOpacityMax:99,grayscale:"yes"}]]},{}],13:[function(t,e,r){function n(t){if(t){console.error(t,t.stack);var e="";t.name&&(e+=t.name+": "),e+=t.message,t.stack&&(e+=" | "+t.stack.toString()),function(t){var e=document.getElementById("status-message");e.textContent=t,e.classList.remove("hidden")}(e)}}e.exports=n},{}],14:[function(t,e,r){(function(t){function n(t,e){return t.set(e[0],e[1]),t}function o(t,e){return t.add(e),t}function i(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function a(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function c(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function u(t,e){return function(r){return t(e(r))}}function s(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function l(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function f(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function h(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function p(t){this.__data__=new f(t)}function d(t,e){var r=Wt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&C(t)}(t)&&mt.call(t,"callee")&&(!Ct.call(t,"callee")||bt.call(t)==T)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!mt.call(t,i)||o&&("length"==i||function(t,e){return!!(e=null==e?D:e)&&("number"==typeof t||ot.test(t))&&t>-1&&t%1==0&&t<e}(i,n))||r.push(i);return r}function y(t,e,r){var n=t[e];mt.call(t,e)&&A(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function g(t,e){for(var r=t.length;r--;)if(A(t[r][0],e))return r;return-1}function v(t,e,r,u,l,f,h){var d;if(u&&(d=f?u(t,l,f,h):u(t)),void 0!==d)return d;if(!k(t))return t;var g=Wt(t);if(g){if(d=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&mt.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,d)}else{var m=Vt(t),x=m==N||m==P;if(Gt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(m==$||m==T||x&&!f){if(a(t))return f?t:{};if(d=function(t){return"function"!=typeof t.constructor||O(t)?{}:function(t){return k(t)?At(t):{}}(Mt(t))}(x?{}:t),!e)return function(t,e){return w(t,Ht(t),e)}(t,function(t,e){return t&&w(e,q(e),t)}(d,t))}else{if(!it[m])return f?t:{};d=function(t,e,r,a){var u=t.constructor;switch(e){case V:return b(t);case I:case E:return new u(+t);case W:return function(t,e){var r=e?b(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,a);case G:case X:case Q:case J:case K:case Y:case Z:case tt:case et:return function(t,e){var r=e?b(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,a);case B:return function(t,e,r){return i(e?r(c(t),!0):c(t),n,new t.constructor)}(t,a,r);case F:case z:return new u(t);case L:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case U:return function(t,e,r){return i(e?r(s(t),!0):s(t),o,new t.constructor)}(t,a,r);case H:return function(t){return zt?Object(zt.call(t)):{}}(t)}}(t,m,v,e)}}h||(h=new p);var j=h.get(t);if(j)return j;if(h.set(t,d),!g)var M=r?function(t){return function(t,e,r){var n=e(t);return Wt(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,q,Ht)}(t):q(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(M||t,function(n,o){M&&(n=t[o=n]),y(d,o,v(n,e,r,u,o,t,h))}),d}function m(t){if(!k(t)||function(t){return!!gt&&gt in t}(t))return!1;return(_(t)||a(t)?wt:nt).test(M(t))}function b(t){var e=new t.constructor(t.byteLength);return new Ot(e).set(new Ot(t)),e}function w(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],c=n?n(r[a],t[a],a,r,t):void 0;y(r,a,void 0===c?t[a]:c)}return r}function x(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function j(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return m(r)?r:void 0}function O(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||dt)}function M(t){if(null!=t){try{return vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function A(t,e){return t===e||t!=t&&e!=e}function C(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=D}(t.length)&&!_(t)}function _(t){var e=k(t)?bt.call(t):"";return e==N||e==P}function k(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function q(t){return C(t)?d(t):function(t){if(!O(t))return Rt(t);var e=[];for(var r in Object(t))mt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}var R=200,S="__lodash_hash_undefined__",D=9007199254740991,T="[object Arguments]",I="[object Boolean]",E="[object Date]",N="[object Function]",P="[object GeneratorFunction]",B="[object Map]",F="[object Number]",$="[object Object]",L="[object RegExp]",U="[object Set]",z="[object String]",H="[object Symbol]",V="[object ArrayBuffer]",W="[object DataView]",G="[object Float32Array]",X="[object Float64Array]",Q="[object Int8Array]",J="[object Int16Array]",K="[object Int32Array]",Y="[object Uint8Array]",Z="[object Uint8ClampedArray]",tt="[object Uint16Array]",et="[object Uint32Array]",rt=/\w*$/,nt=/^\[object .+?Constructor\]$/,ot=/^(?:0|[1-9]\d*)$/,it={};it[T]=it["[object Array]"]=it[V]=it[W]=it[I]=it[E]=it[G]=it[X]=it[Q]=it[J]=it[K]=it[B]=it[F]=it[$]=it[L]=it[U]=it[z]=it[H]=it[Y]=it[Z]=it[tt]=it[et]=!0,it["[object Error]"]=it[N]=it["[object WeakMap]"]=!1;var at="object"==typeof t&&t&&t.Object===Object&&t,ct="object"==typeof self&&self&&self.Object===Object&&self,ut=at||ct||Function("return this")(),st="object"==typeof r&&r&&!r.nodeType&&r,lt=st&&"object"==typeof e&&e&&!e.nodeType&&e,ft=lt&&lt.exports===st,ht=Array.prototype,pt=Function.prototype,dt=Object.prototype,yt=ut["__core-js_shared__"],gt=function(){var t=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),vt=pt.toString,mt=dt.hasOwnProperty,bt=dt.toString,wt=RegExp("^"+vt.call(mt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xt=ft?ut.Buffer:void 0,jt=ut.Symbol,Ot=ut.Uint8Array,Mt=u(Object.getPrototypeOf,Object),At=Object.create,Ct=dt.propertyIsEnumerable,_t=ht.splice,kt=Object.getOwnPropertySymbols,qt=xt?xt.isBuffer:void 0,Rt=u(Object.keys,Object),St=j(ut,"DataView"),Dt=j(ut,"Map"),Tt=j(ut,"Promise"),It=j(ut,"Set"),Et=j(ut,"WeakMap"),Nt=j(Object,"create"),Pt=M(St),Bt=M(Dt),Ft=M(Tt),$t=M(It),Lt=M(Et),Ut=jt?jt.prototype:void 0,zt=Ut?Ut.valueOf:void 0;l.prototype.clear=function(){this.__data__=Nt?Nt(null):{}},l.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},l.prototype.get=function(t){var e=this.__data__;if(Nt){var r=e[t];return r===S?void 0:r}return mt.call(e,t)?e[t]:void 0},l.prototype.has=function(t){var e=this.__data__;return Nt?void 0!==e[t]:mt.call(e,t)},l.prototype.set=function(t,e){return this.__data__[t]=Nt&&void 0===e?S:e,this},f.prototype.clear=function(){this.__data__=[]},f.prototype.delete=function(t){var e=this.__data__,r=g(e,t);return!(r<0||(r==e.length-1?e.pop():_t.call(e,r,1),0))},f.prototype.get=function(t){var e=this.__data__,r=g(e,t);return r<0?void 0:e[r][1]},f.prototype.has=function(t){return g(this.__data__,t)>-1},f.prototype.set=function(t,e){var r=this.__data__,n=g(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},h.prototype.clear=function(){this.__data__={hash:new l,map:new(Dt||f),string:new l}},h.prototype.delete=function(t){return x(this,t).delete(t)},h.prototype.get=function(t){return x(this,t).get(t)},h.prototype.has=function(t){return x(this,t).has(t)},h.prototype.set=function(t,e){return x(this,t).set(t,e),this},p.prototype.clear=function(){this.__data__=new f},p.prototype.delete=function(t){return this.__data__.delete(t)},p.prototype.get=function(t){return this.__data__.get(t)},p.prototype.has=function(t){return this.__data__.has(t)},p.prototype.set=function(t,e){var r=this.__data__;if(r instanceof f){var n=r.__data__;if(!Dt||n.length<R-1)return n.push([t,e]),this;r=this.__data__=new h(n)}return r.set(t,e),this};var Ht=kt?u(kt,Object):function(){return[]},Vt=function(t){return bt.call(t)};(St&&Vt(new St(new ArrayBuffer(1)))!=W||Dt&&Vt(new Dt)!=B||Tt&&"[object Promise]"!=Vt(Tt.resolve())||It&&Vt(new It)!=U||Et&&"[object WeakMap]"!=Vt(new Et))&&(Vt=function(t){var e=bt.call(t),r=e==$?t.constructor:void 0,n=r?M(r):void 0;if(n)switch(n){case Pt:return W;case Bt:return B;case Ft:return"[object Promise]";case $t:return U;case Lt:return"[object WeakMap]"}return e});var Wt=Array.isArray,Gt=qt||function(){return!1};e.exports=function(t){return v(t,!0,!0)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(t,e,r){e.exports=function(t){for(var e=-1,r=t?t.length:0,n=0,o=[];++e<r;){var i=t[e];i&&(o[n++]=i)}return o}},{}],16:[function(t,e,r){(function(t){function r(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function n(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,o,r);var n=r-1,i=t.length;for(;++n<i;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function o(t){return t!=t}function i(t,e){for(var r=-1,n=t.length,o=0,i=[];++r<n;){var a=t[r];a!==e&&a!==b||(t[r]=b,i[o++]=r)}return i}function a(t){if(!y(t)||function(t){return!!Z&&Z in t}(t))return!1;return(function(t){var e=y(t)?rt.call(t):"";return e==I||e==E}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?nt:z).test(function(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function c(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=function(t){return y(t)?ot(t):{}}(t.prototype),n=t.apply(r,e);return y(n)?n:r}}function u(t,e,r,n,o,a,l,h,d,y){function g(){for(var w=arguments.length,x=Array(w),O=w;O--;)x[O]=arguments[O];if(j)var M=f(g),_=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&n++;return n}(x,M);if(n&&(x=function(t,e,r,n){for(var o=-1,i=t.length,a=r.length,c=-1,u=e.length,s=it(i-a,0),l=Array(u+s),f=!n;++c<u;)l[c]=e[c];for(;++o<a;)(f||o<i)&&(l[r[o]]=t[o]);for(;s--;)l[c++]=t[o++];return l}(x,n,o,j)),a&&(x=function(t,e,r,n){for(var o=-1,i=t.length,a=-1,c=r.length,u=-1,s=e.length,l=it(i-c,0),f=Array(l+s),h=!n;++o<l;)f[o]=t[o];for(var p=o;++u<s;)f[p+u]=e[u];for(;++a<c;)(h||o<i)&&(f[p+r[a]]=t[o++]);return f}(x,a,l,j)),w-=_,j&&w<y){var k=i(x,M);return s(t,e,u,g.placeholder,r,x,k,h,d,y-w)}var q=m?r:this,R=b?q[t]:t;return w=x.length,h?x=function(t,e){var r=t.length,n=at(e.length,r),o=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t);for(;n--;){var i=e[n];t[n]=p(i,r)?o[i]:void 0}return t}(x,h):A&&w>1&&x.reverse(),v&&d<w&&(x.length=d),this&&this!==Q&&this instanceof g&&(R=C||c(R)),R.apply(q,x)}var v=e&_,m=e&w,b=e&x,j=e&(O|M),A=e&k,C=b?void 0:c(t);return g}function s(t,e,r,n,o,i,a,c,u,s){var l=e&O;e|=l?A:C,(e&=~(l?C:A))&j||(e&=~(w|x));var f=r(t,e,o,l?i:void 0,l?a:void 0,l?void 0:i,l?void 0:a,c,u,s);return f.placeholder=n,ut(f,t,e)}function l(t,e,n,o,a,l,h,p){var d=e&x;if(!d&&"function"!=typeof t)throw new TypeError(m);var y=o?o.length:0;if(y||(e&=~(A|C),o=a=void 0),h=void 0===h?h:it(v(h),0),p=void 0===p?p:v(p),y-=a?a.length:0,e&C){var g=o,b=a;o=a=void 0}var j=[t,e,n,o,a,g,b,l,h,p];if(t=j[0],e=j[1],n=j[2],o=j[3],a=j[4],!(p=j[9]=null==j[9]?d?0:t.length:it(j[9]-y,0))&&e&(O|M)&&(e&=~(O|M)),e&&e!=w)_=e==O||e==M?function(t,e,n){function o(){for(var c=arguments.length,l=Array(c),h=c,p=f(o);h--;)l[h]=arguments[h];var d=c<3&&l[0]!==p&&l[c-1]!==p?[]:i(l,p);return(c-=d.length)<n?s(t,e,u,o.placeholder,void 0,l,d,void 0,void 0,n-c):r(this&&this!==Q&&this instanceof o?a:t,this,l)}var a=c(t);return o}(t,e,p):e!=A&&e!=(w|A)||a.length?u.apply(void 0,j):function(t,e,n,o){function i(){for(var e=-1,c=arguments.length,s=-1,l=o.length,f=Array(l+c),h=this&&this!==Q&&this instanceof i?u:t;++s<l;)f[s]=o[s];for(;c--;)f[s++]=arguments[++e];return r(h,a?n:this,f)}var a=e&w,u=c(t);return i}(t,e,n,o);else var _=function(t,e,r){function n(){return(this&&this!==Q&&this instanceof n?i:t).apply(o?r:this,arguments)}var o=e&w,i=c(t);return n}(t,e,n);return ut(_,t,e)}function f(t){return t.placeholder}function h(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return a(r)?r:void 0}function p(t,e){return!!(e=null==e?R:e)&&("number"==typeof t||V.test(t))&&t>-1&&t%1==0&&t<e}function d(t,e,r){var n=l(t,O,void 0,void 0,void 0,void 0,void 0,e=r?void 0:e);return n.placeholder=d.placeholder,n}function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if(!t)return 0===t?t:0;if((t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&rt.call(t)==N}(t))return D;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(P,"");var r=U.test(t);return r||H.test(t)?W(t.slice(2),r?2:8):L.test(t)?D:+t}(t))===q||t===-q){return(t<0?-1:1)*S}return t==t?t:0}function v(t){var e=g(t),r=e%1;return e==e?r?e-r:e:0}var m="Expected a function",b="__lodash_placeholder__",w=1,x=2,j=4,O=8,M=16,A=32,C=64,_=128,k=512,q=1/0,R=9007199254740991,S=1.7976931348623157e308,D=NaN,T=[["ary",_],["bind",w],["bindKey",x],["curry",O],["curryRight",M],["flip",k],["partial",A],["partialRight",C],["rearg",256]],I="[object Function]",E="[object GeneratorFunction]",N="[object Symbol]",P=/^\s+|\s+$/g,B=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,F=/\{\n\/\* \[wrapped with (.+)\] \*/,$=/,? & /,L=/^[-+]0x[0-9a-f]+$/i,U=/^0b[01]+$/i,z=/^\[object .+?Constructor\]$/,H=/^0o[0-7]+$/i,V=/^(?:0|[1-9]\d*)$/,W=parseInt,G="object"==typeof t&&t&&t.Object===Object&&t,X="object"==typeof self&&self&&self.Object===Object&&self,Q=G||X||Function("return this")(),J=Function.prototype,K=Object.prototype,Y=Q["__core-js_shared__"],Z=function(){var t=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),tt=J.toString,et=K.hasOwnProperty,rt=K.toString,nt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=Object.create,it=Math.max,at=Math.min,ct=function(){var t=h(Object,"defineProperty"),e=h.name;return e&&e.length>2?t:void 0}(),ut=ct?function(t,e,r){var o=e+"";return ct(t,"toString",{configurable:!0,enumerable:!1,value:function(t){return function(){return t}}(function(t,e){var r=e.length,n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(B,"{\n/* [wrapped with "+e+"] */\n")}(o,function(t,e){return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(T,function(r){var o="_."+r[0];e&r[1]&&!n(t,o)&&t.push(o)}),t.sort()}(function(t){var e=t.match(F);return e?e[1].split($):[]}(o),r)))})}:function(t){return t};d.placeholder={},e.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(t,e,r){function n(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function o(t,e){var r=M(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&h(t)}(t)&&w.call(t,"callee")&&(!j.call(t,"callee")||x.call(t)==y)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!w.call(t,i)||o&&("length"==i||l(i,n))||r.push(i);return r}function i(t,e,r,n){return void 0===t||f(t,b[r])&&!w.call(n,r)?e:t}function a(t,e,r){var n=t[e];w.call(t,e)&&f(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function c(t){if(!p(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=function(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||b;return t===r}(t),r=[];for(var n in t)("constructor"!=n||!e&&w.call(t,n))&&r.push(n);return r}function u(t,e){return e=O(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=O(r.length-e,0),a=Array(i);++o<i;)a[o]=r[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=r[o];return c[e]=a,n(t,this,c)}}function s(t){return u(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(t,e,r){if(!p(r))return!1;var n=typeof e;if("number"==n?h(r)&&l(e,r.length):"string"==n&&e in r)return f(r[e],t);return!1}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var c=r[n];c&&t(e,c,n,i)}return e})}function l(t,e){return!!(e=null==e?d:e)&&("number"==typeof t||m.test(t))&&t>-1&&t%1==0&&t<e}function f(t,e){return t===e||t!=t&&e!=e}function h(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=d}(t.length)&&!function(t){var e=p(t)?x.call(t):"";return e==g||e==v}(t)}function p(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var d=9007199254740991,y="[object Arguments]",g="[object Function]",v="[object GeneratorFunction]",m=/^(?:0|[1-9]\d*)$/,b=Object.prototype,w=b.hasOwnProperty,x=b.toString,j=b.propertyIsEnumerable,O=Math.max,M=Array.isArray,A=s(function(t,e,r,n){!function(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var c=e[o],u=n?n(r[c],t[c],c,r,t):void 0;a(r,c,void 0===u?t[c]:u)}}(e,function(t){return h(t)?o(t,!0):c(t)}(e),t,n)}),C=u(function(t){return t.push(void 0,i),n(A,void 0,t)});e.exports=C},{}],18:[function(t,e,r){e.exports=function(t,e){var r=t;return e.every(function(t){return r=r[t]},!0)}},{}],19:[function(t,e,r){function n(t){function e(t){return Math.floor(h()*t)}function r(t){function r(t){return function(t,e){e=+e;for(var r=0;r<t.length;++r){var n=t[r],o=n[0];if(e>=o[0]&&e<=o[1])return n[1]}}(n,t)}var n=t,o=n[n.length-1][0][1]-n[0][0][0]+1;return{outcomeAtIndex:r,roll:function(){var t=r(e(o));return"function"!=typeof t||"probable_rollOnTable"!==t.name&&"probable_pick"!==t.name?t:t()},length:o,getRangesAndOutcomesArray:function(){return n}}}function n(t){var e=[],r=-1,n=function(t){var e=[];for(var r in t){var n=t[r];e.push([n,r])}return e}(t);return(n=n.sort(o)).forEach(function(t){var n=t[0],o=t[1],i=r+1,a=i+n-1;e.push([[i,a],o]),r=a}),e}function o(t,e){return t[0]>e[0]?-1:1}function i(t){return r(function(t){var e=[];for(var r in t){var n=function(t){var e=t.split("-");if(e.length>2)return;return 1===e.length?[+t,+t]:[+e[0],+e[1]]}(r),o=t[r];if("object"==typeof o)if(Array.isArray(o))o=s(o);else{var c=i(o);"function"==typeof c.roll&&(o=c.roll)}e.push([n,o])}return e.sort(a)}(t))}function a(t,e){return t[0][0]<e[0][0]?-1:1}function c(t){return r(function(t){function e(t){var e=t[0],n=t[1],o=r+e-1,i=[r,o];if(r=o+1,Array.isArray(n))if(function(t){return Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&2===t[0].length&&"number"==typeof t[0][0]}(n)){var a=c(n);"function"==typeof a.roll&&(n=a.roll)}else n=s(n);return[i,n]}var r=0;return t.map(e)}(t))}function u(t,r){return!t||"number"!=typeof t.length||t.length<1?r:t[e(t.length)]}function s(t,e){return function(){return u(t,e)}}function l(t,e){var r=[];return t.forEach(function(t){e.forEach(function(e){Array.isArray(t)||Array.isArray(e)?r.push(t.concat(e)):r.push([t,e])})}),r}function f(t){for(var r,n=t.length,o=Array(n),i=0;i<n;i++)(r=e(i+1))!==i&&(o[i]=o[r]),o[r]=t[i];return o}var h=Math.random;return t&&t.random&&(h=t.random),{roll:e,rollDie:function(t){return 0===t?0:e(t)+1},createRangeTable:r,createRangeTableFromDict:function(t){return r(n(t))},createTableFromDef:i,createTableFromSizes:c,convertDictToRangesAndOutcomePairs:n,pickFromArray:u,crossArrays:l,getCartesianProduct:function(t){return t.slice(1).reduce(l,t[0])},shuffle:f,sample:function(t,e){return f(t).slice(0,e)},randomFn:h}}var o=n();"object"==typeof e&&(e.exports=o,e.exports.createProbable=n)},{}],20:[function(t,e,r){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function a(){y&&p&&(y=!1,p.length?d=p.concat(d):g=-1,d.length&&c())}function c(){if(!y){var t=i(a);y=!0;for(var e=d.length;e;){for(p=d,d=[];++g<e;)p&&p[g].run();g=-1,e=d.length}p=null,y=!1,function(t){if(f===clearTimeout)return clearTimeout(t);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}(t)}}function u(t,e){this.fun=t,this.array=e}function s(){}var l,f,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(t){f=o}}();var p,d=[],y=!1,g=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new u(t,e)),1!==d.length||y||i(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=s,h.addListener=s,h.once=s,h.off=s,h.removeListener=s,h.removeAllListeners=s,h.emit=s,h.prependListener=s,h.prependOnceListener=s,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],21:[function(t,e,r){"use strict";var n=String.prototype.replace,o=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(t){return n.call(t,o,"+")},RFC3986:function(t){return t}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},{}],22:[function(t,e,r){"use strict";var n=t("./stringify"),o=t("./parse"),i=t("./formats");e.exports={formats:i,parse:o,stringify:n}},{"./formats":21,"./parse":23,"./stringify":24}],23:[function(t,e,r){"use strict";var n=t("./utils"),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(t,e,r){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,i=/(\[[^[\]]*])/g,a=/(\[[^[\]]*])/.exec(n),c=a?n.slice(0,a.index):n,u=[];if(c){if(!r.plainObjects&&o.call(Object.prototype,c)&&!r.allowPrototypes)return;u.push(c)}for(var s=0;null!==(a=i.exec(n))&&s<r.depth;){if(s+=1,!r.plainObjects&&o.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+n.slice(a.index)+"]"),function(t,e,r){for(var n=e,o=t.length-1;o>=0;--o){var i,a=t[o];if("[]"===a)i=(i=[]).concat(n);else{i=r.plainObjects?Object.create(null):{};var c="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(c,10);!isNaN(u)&&a!==c&&String(u)===c&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(i=[])[u]=n:i[c]=n}n=i}return n}(u,e,r)}};e.exports=function(t,e){var r=e?n.assign({},e):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||n.isRegExp(r.delimiter)?r.delimiter:i.delimiter,r.depth="number"==typeof r.depth?r.depth:i.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:i.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:i.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:i.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:i.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:i.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:i.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:i.strictNullHandling,""===t||null===t||void 0===t)return r.plainObjects?Object.create(null):{};for(var c="string"==typeof t?function(t,e){for(var r={},n=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,a=e.parameterLimit===1/0?void 0:e.parameterLimit,c=n.split(e.delimiter,a),u=0;u<c.length;++u){var s,l,f=c[u],h=f.indexOf("]="),p=-1===h?f.indexOf("="):h+1;-1===p?(s=e.decoder(f,i.decoder),l=e.strictNullHandling?null:""):(s=e.decoder(f.slice(0,p),i.decoder),l=e.decoder(f.slice(p+1),i.decoder)),o.call(r,s)?r[s]=[].concat(r[s]).concat(l):r[s]=l}return r}(t,r):t,u=r.plainObjects?Object.create(null):{},s=Object.keys(c),l=0;l<s.length;++l){var f=s[l],h=a(f,c[f],r);u=n.merge(u,h,r)}return n.compact(u)}},{"./utils":25}],24:[function(t,e,r){"use strict";var n=t("./utils"),o=t("./formats"),i={brackets:function(t){return t+"[]"},indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},a=Date.prototype.toISOString,c={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(t){return a.call(t)},skipNulls:!1,strictNullHandling:!1},u=function t(e,r,o,i,a,u,s,l,f,h,p,d){var y=e;if("function"==typeof s)y=s(r,y);else if(y instanceof Date)y=h(y);else if(null===y){if(i)return u&&!d?u(r,c.encoder):r;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||n.isBuffer(y)){if(u){return[p(d?r:u(r,c.encoder))+"="+p(u(y,c.encoder))]}return[p(r)+"="+p(String(y))]}var g=[];if(void 0===y)return g;var v;if(Array.isArray(s))v=s;else{var m=Object.keys(y);v=l?m.sort(l):m}for(var b=0;b<v.length;++b){var w=v[b];a&&null===y[w]||(g=Array.isArray(y)?g.concat(t(y[w],o(r,w),o,i,a,u,s,l,f,h,p,d)):g.concat(t(y[w],r+(f?"."+w:"["+w+"]"),o,i,a,u,s,l,f,h,p,d)))}return g};e.exports=function(t,e){var r=t,a=e?n.assign({},e):{};if(null!==a.encoder&&void 0!==a.encoder&&"function"!=typeof a.encoder)throw new TypeError("Encoder has to be a function.");var s=void 0===a.delimiter?c.delimiter:a.delimiter,l="boolean"==typeof a.strictNullHandling?a.strictNullHandling:c.strictNullHandling,f="boolean"==typeof a.skipNulls?a.skipNulls:c.skipNulls,h="boolean"==typeof a.encode?a.encode:c.encode,p="function"==typeof a.encoder?a.encoder:c.encoder,d="function"==typeof a.sort?a.sort:null,y=void 0!==a.allowDots&&a.allowDots,g="function"==typeof a.serializeDate?a.serializeDate:c.serializeDate,v="boolean"==typeof a.encodeValuesOnly?a.encodeValuesOnly:c.encodeValuesOnly;if(void 0===a.format)a.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,a.format))throw new TypeError("Unknown format option provided.");var m,b,w=o.formatters[a.format];"function"==typeof a.filter?r=(b=a.filter)("",r):Array.isArray(a.filter)&&(m=b=a.filter);var x=[];if("object"!=typeof r||null===r)return"";var j;j=a.arrayFormat in i?a.arrayFormat:"indices"in a?a.indices?"indices":"repeat":"indices";var O=i[j];m||(m=Object.keys(r)),d&&m.sort(d);for(var M=0;M<m.length;++M){var A=m[M];f&&null===r[A]||(x=x.concat(u(r[A],A,O,l,f,h?p:null,b,d,y,g,w,v)))}var C=x.join(s),_=!0===a.addQueryPrefix?"?":"";return C.length>0?_+C:""}},{"./formats":21,"./utils":25}],25:[function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),i=function(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},n=0;n<t.length;++n)void 0!==t[n]&&(r[n]=t[n]);return r};e.exports={arrayToObject:i,assign:function(t,e){return Object.keys(e).reduce(function(t,r){return t[r]=e[r],t},t)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],n=0;n<e.length;++n)for(var o=e[n],i=o.obj[o.prop],a=Object.keys(i),c=0;c<a.length;++c){var u=a[c],s=i[u];"object"==typeof s&&null!==s&&-1===r.indexOf(s)&&(e.push({obj:i,prop:u}),r.push(s))}return function(t){for(var e;t.length;){var r=t.pop();if(e=r.obj[r.prop],Array.isArray(e)){for(var n=[],o=0;o<e.length;++o)void 0!==e[o]&&n.push(e[o]);r.obj[r.prop]=n}}return e}(e)},decode:function(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return t}},encode:function(t){if(0===t.length)return t;for(var e="string"==typeof t?t:String(t),r="",n=0;n<e.length;++n){var i=e.charCodeAt(n);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?r+=e.charAt(n):i<128?r+=o[i]:i<2048?r+=o[192|i>>6]+o[128|63&i]:i<55296||i>=57344?r+=o[224|i>>12]+o[128|i>>6&63]+o[128|63&i]:(n+=1,i=65536+((1023&i)<<10|1023&e.charCodeAt(n)),r+=o[240|i>>18]+o[128|i>>12&63]+o[128|i>>6&63]+o[128|63&i])}return r},isBuffer:function(t){return null!==t&&void 0!==t&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},merge:function t(e,r,o){if(!r)return e;if("object"!=typeof r){if(Array.isArray(e))e.push(r);else{if("object"!=typeof e)return[e,r];(o.plainObjects||o.allowPrototypes||!n.call(Object.prototype,r))&&(e[r]=!0)}return e}if("object"!=typeof e)return[e].concat(r);var a=e;return Array.isArray(e)&&!Array.isArray(r)&&(a=i(e,o)),Array.isArray(e)&&Array.isArray(r)?(r.forEach(function(r,i){n.call(e,i)?e[i]&&"object"==typeof e[i]?e[i]=t(e[i],r,o):e.push(r):e[i]=r}),e):Object.keys(r).reduce(function(e,i){var a=r[i];return n.call(e,i)?e[i]=t(e[i],a,o):e[i]=a,e},a)}}},{}],26:[function(t,e,r){function n({request:t,query:e,collection:r,mediatype:n,fileExtensions:g,minimumSize:v=0,maximumSize:m=-1,random:b=Math.random,proxyBaseURL:w="https://archive.org"},x){function j(t){return!(g&&!g.some(function(e){return t.name.endsWith(e)}))&&(!(v>0&&+t.size<v)&&!(!isNaN(m)&&+t.size>m))}function O({query:e,collection:r,mediatype:n,page:a},c){var s={method:"GET",url:function({iaQueryDict:t,fields:e,rows:r,page:n,query:a}){return`${w}/advancedsearch.php?q=`+o(t,a)+"&"+e.map(i).join("&")+"&"+`rows=${r}`+"&"+`page=${n}`+"&output=json&callback="}({query:e,iaQueryDict:{collection:r,mediatype:n},fields:["identifier","item_size","title"],rows:y,page:a}),json:!0};console.log("url:",s.url),t(s,u(c))}var M=h({random:b}),A={query:e,collection:r,mediatype:n,page:0};c([s(function({query:e,collection:r,mediatype:n},i){var a={method:"GET",url:`${w}/services/search/v1/scrape?debug=false&xvar=production&total_only=true&q=`+o({collection:r,mediatype:n},e),json:!0};t(a,u(i))})(A),a({channel:A,properties:["total"],noErrorParam:!0}),function({total:t},e){if(t<1)f(e,new Error("No items found."));else{t>d&&(console.log("There are",t,"results. We can only get from the first",d),t=d);let r=Math.floor(t/y);f(e,null,{page:M.roll(r),row:M.roll(y)})}},a({channel:A,properties:["page","row"],noErrorParam:!0}),O,a({channel:A,properties:[[function(t){if(l(t,["response","docs",A.row]))return t.response.docs[A.row]},"item"]],noErrorParam:!0}),function({item:e},r){var n={method:"GET",url:`https://archive.org/metadata/${e.identifier}`,json:!0};t(n,u(r))},a({channel:A,properties:["dir","files","workable_servers"],noErrorParam:!0}),function({files:t,item:e},r){var n=p(t).filter(j);n.length<1?f(r,new Error(`No usable files found for ${e.identifier}.`)):f(r,null,{files:n})},a({channel:A,properties:["files"],noErrorParam:!0}),function({collection:t,item:e,dir:r,files:n,workable_servers:o},i){var a=M.pickFromArray(o),c=M.pickFromArray(n),u=`https://${a}${r}/${c.name}`;f(i,null,{url:u,collection:t,title:e.title,size:c.size,format:c.format,detailsURL:`${w}/details/${e.identifier}`})}],x)}function o(t,e){var r=p(Object.keys(t).map(function(e){if(t[e])return encodeURIComponent(`${e}:(${t[e]})`)})).join("+AND+");return e&&(r=encodeURIComponent(`(${e}) AND `)+r),r}function i(t){return`fl[]=${t}`}var a=t("collect-in-channel"),c=t("async-waterfall"),u=t("request-body-mover"),s=t("lodash.curry"),l=t("object-path-exists"),f=t("call-next-tick"),h=t("probable").createProbable,p=t("lodash.compact");const d=1e4,y=100;e.exports=n},{"async-waterfall":6,"call-next-tick":9,"collect-in-channel":10,"lodash.compact":15,"lodash.curry":16,"object-path-exists":18,probable:19,"request-body-mover":27}],27:[function(t,e,r){function n(t){return t.statusCode>199&&t.statusCode<300}e.exports=function(t,e){var r;if("object"==typeof t){var{url:o,responseIsOK:i}=t;r=e}else r=t;return i||(i=n),function(t,e,a){if(t)r(t);else if(i(e))r(null,a);else{let t="";t=i===n?`Received status code ${e.statusCode}`:"Bad response",o?t+=` from ${o} `:e.url&&(t+=` from ${e.url} `),t+=".",r(new Error(t))}}}},{}],28:[function(t,e,r){var n=t("qs"),o=t("lodash.clonedeep"),i=t("lodash.defaults");e.exports=function(t){function e(){c(r())}function r(){return n.parse(u.location.hash.slice(1))}function a(t){var e=u.location.protocol+"//"+u.location.host+u.location.pathname+"#"+n.stringify(t);u.history.pushState(null,null,e)}var c,u;return t&&(c=t.followRoute,u=t.windowObject),u.onhashchange=e,{addToRoute:function(t,e=!0){var n=i(o(t),r());a(n),e&&c(n)},overwriteRouteEntirely:function(t){a(t),c(t)},routeFromHash:e,unpackEncodedRoute:function(t){var e=n.parse(decodeURIComponent(t));a(e),c(e)}}}},{"lodash.clonedeep":14,"lodash.defaults":17,qs:22}],29:[function(t,e,r){var n=t("./lib/alea"),o=t("./lib/xor128"),i=t("./lib/xorwow"),a=t("./lib/xorshift7"),c=t("./lib/xor4096"),u=t("./lib/tychei"),s=t("./seedrandom");s.alea=n,s.xor128=o,s.xorwow=i,s.xorshift7=a,s.xor4096=c,s.tychei=u,e.exports=s},{"./lib/alea":30,"./lib/tychei":31,"./lib/xor128":32,"./lib/xor4096":33,"./lib/xorshift7":34,"./lib/xorwow":35,"./seedrandom":36}],30:[function(t,e,r){!function(t,e,r){function n(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var r=new function(t){var e=this,r=function(){var t=4022871197;return function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}(t),o=e&&e.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+1.1102230246251565e-16*(2097152*i()|0)},i.quick=i,o&&("object"==typeof o&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.alea=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],31:[function(t,e,r){!function(t,e,r){function n(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,o=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}(t),o=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=r.next,i.quick=i,o&&("object"==typeof o&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],32:[function(t,e,r){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var r=new function(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}(t),o=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=r.next,i.quick=i,o&&("object"==typeof o&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],33:[function(t,e,r){!function(t,e,r){function n(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.w,o=e.X,i=e.i;return e.w=n=n+1640531527|0,r=o[i+34&127],t=o[i=i+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=o[i]=r^t,e.i=i,r+(n^n>>>16)|0},function(t,e){var r,n,o,i,a,c=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),o=0,i=-32;i<u;++i)e&&(n^=e.charCodeAt((i+32)%e.length)),0===i&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,i>=0&&(a=a+1640531527|0,o=0==(r=c[127&i]^=n+a)?o+1:0);for(o>=128&&(c[127&(e&&e.length||0)]=-1),o=127,i=512;i>0;--i)n=c[o+34&127],r=c[o=o+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,c[o]=n^r;t.w=a,t.X=c,t.i=o}(e,t)}(t),o=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=r.next,i.quick=i,o&&(o.X&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],34:[function(t,e,r){!function(t,e,r){function n(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.x,o=e.i;return t=n[o],t^=t>>>7,r=t^t<<24,t=n[o+1&7],r^=t^t>>>10,t=n[o+3&7],r^=t^t>>>3,t=n[o+4&7],r^=t^t<<7,t=n[o+7&7],t^=t<<13,r^=t^t<<9,n[o]=r,e.i=o+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}(t),o=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=r.next,i.quick=i,o&&(o.x&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],35:[function(t,e,r){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),o=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=r.next,i.quick=i,o&&("object"==typeof o&&n(o,r),i.state=function(){return n(r,{})}),i}e&&e.exports?e.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o}(0,"object"==typeof e&&e,"function"==typeof define&&define)},{}],36:[function(t,e,r){!function(r,n){function o(t,e,o){var m=[],b=c(a((e=1==e?{entropy:!0}:e||{}).entropy?[t,u(r)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(f):(t=new Uint8Array(f),(l.crypto||l.msCrypto).getRandomValues(t)),u(t)}catch(t){var e=l.navigator,n=e&&e.plugins;return[+new Date,l,n,l.screen,u(r)]}}():t,3),m),w=new function(t){var e,r=t.length,n=this,o=0,i=n.i=n.j=0,a=n.S=[];r||(t=[r++]);for(;o<f;)a[o]=o++;for(o=0;o<f;o++)a[o]=a[i=v&i+t[o%r]+(e=a[o])],a[i]=e;(n.g=function(t){for(var e,r=0,o=n.i,i=n.j,a=n.S;t--;)e=a[o=v&o+1],r=r*f+a[v&(a[o]=a[i=v&i+e])+(a[i]=e)];return n.i=o,n.j=i,r})(f)}(m),x=function(){for(var t=w.g(h),e=d,r=0;t<y;)t=(t+r)*f,e*=f,r=w.g(1);for(;t>=g;)t/=2,e/=2,r>>>=1;return(t+r)/e};return x.int32=function(){return 0|w.g(4)},x.quick=function(){return w.g(4)/4294967296},x.double=x,c(u(w.S),r),(e.pass||o||function(t,e,r,o){return o&&(o.S&&i(o,w),t.state=function(){return i(w,{})}),r?(n[p]=t,e):t})(x,b,"global"in e?e.global:this==n,e.state)}function i(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function a(t,e){var r,n=[],o=typeof t;if(e&&"object"==o)for(r in t)try{n.push(a(t[r],e-1))}catch(t){}return n.length?n:"string"==o?t:t+"\0"}function c(t,e){for(var r,n=t+"",o=0;o<n.length;)e[v&o]=v&(r^=19*e[v&o])+n.charCodeAt(o++);return u(e)}function u(t){return String.fromCharCode.apply(0,t)}var s,l=(0,eval)("this"),f=256,h=6,p="random",d=n.pow(f,h),y=n.pow(2,52),g=2*y,v=f-1;if(n["seed"+p]=o,c(n.random(),r),"object"==typeof e&&e.exports){e.exports=o;try{s=t("crypto")}catch(t){}}else"function"==typeof define&&define.amd&&define(function(){return o})}([],Math)},{crypto:8}],37:[function(t,e,r){e.exports=function(t){var e;return t&&(e=t.log),function(t,r){return function(n){if(n)e&&(n.stack?e(n,n.stack):e(n)),r&&r(n);else if(t){var o=Array.prototype.slice.call(arguments,1);r&&o.push(r),t.apply(t,o)}}}}},{}],38:[function(t,e,r){function n(t){return i(t).l}var o,i=t("d3-color").hsl;class a{constructor(t){this.quantizationFactor=t.quant,this.grayscale=t.grayscale,this.recolorMode=t.recolorMode,this.img=t.img,this.targetCanvas=t.targetCanvas,this.showBase=t.showBase,this.opacityPercentOverBase=t.opacityPercentOverBase,this.numberOfRetriesToAvoidSingleColor=+t.numberOfRetriesToAvoidSingleColor,this.minimumValueDifference=+t.minimumValueDifference,this.maxLength=+t.maxLength,this.useWholeNumberScaleUpFactor="yes"===t.useWholeNumberScaleUpFactor,this.probable=t.probable}start(){this.scaleDownImage(.5)}scaleDownImage(t){var e=this.img,r=document.getElementById("source-canvas");o=e.width;var n=r.getContext("2d"),i=~~(e.width*t),a=~~(e.height*t);r.width=i,r.height=a,this.grayscale&&(n.filter="saturate(0%)"),n.drawImage(e,0,0,i,a),n.filter="none";var c=n.getImageData(0,0,i,a),u=o/i;if(u*i>this.maxLength||u*a>this.maxLength){let t=i;a>t&&(t=a),u=this.maxLength/t}this.useWholeNumberScaleUpFactor&&(u=~~u)<1&&(u=1),this.recolor({srcDataArray:Array.from(c.data),smallWidth:i,smallHeight:a,scale:u})}recolor({srcDataArray:t,scale:e=1,smallWidth:r,smallHeight:o}){var a=this.targetCanvas;a.width=r*e,a.height=o*e;var c=a.getContext("2d");this.showBase&&(c.filter="saturate(0%)",c.drawImage(this.img,0,0,a.width,a.height),c.filter="none",c.globalAlpha=this.opacityPercentOverBase/100);for(var u=0;u<this.numberOfRetriesToAvoidSingleColor;++u){var s=function({rgbaToString:n,recolorMode:o,probable:a}){for(var u={},s={},l=0;l<t.length;l+=4){let f=n(t.slice(l,l+4)),h=u[f];if(!h){if("random"===o)h=n([a.roll(256),a.roll(256),a.roll(256),255]);else if("shiftHue"===o){let t=i(f);t.h=a.roll(360),h=t.toString()}u[f]=h}let p=l/4,d=p%r*e,y=~~(p/r)*e;c.fillStyle=h,c.fillRect(d,y,e,e),s[h]=!0}return Object.keys(s)}({rgbaToString:this.rgbaToString.bind(this),recolorMode:this.recolorMode,probable:this.probable});if(s.length>1){if(this.minimumValueDifference<=0)break;if(function(t,e){for(var r=t.map(n),o=0;o<r.length;++o)for(let t=o;t<r.length;++t)if(Math.abs(r[o]-r[t])>=e)return!0;return!1}(s,this.minimumValueDifference))break}}}rgbaToString(t){return`rgba(${t.slice(0,3).map(this.roundColorRawValue.bind(this)).join(", ")}, ${t[3]/255})`}roundColorRawValue(t){return~~(t/this.quantizationFactor)*this.quantizationFactor}}e.exports=a},{"d3-color":11}]},{},[1]);
!function r(e,t,n){function o(i,c){if(!t[i]){if(!e[i]){var l="function"==typeof require&&require;if(!c&&l)return l(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var s=t[i]={exports:{}};e[i][0].call(s.exports,function(r){var t=e[i][1][r];return o(t||r)},s,s.exports,r,e,t,n)}return t[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(r,e,t){function n(r,e,t,n,o){a(o)}var o,a=r("handle-error-web"),i=r("probable"),c=r("qs");class l{constructor({quant:r=16,srcImgUrl:e="data/fish.jpg"}){this.quantizationFactor=r,this.srcImgUrl=e}loadSourceImage(){var r=new Image;r.addEventListener("load",function(){this.scaleDownImage(r,.5)}.bind(this)),r.src=this.srcImgUrl}scaleDownImage(r,e){var t=document.getElementById("source-canvas");o=r.width;var n=t.getContext("2d"),a=~~(r.width*e),i=~~(r.height*e);t.width=a,t.height=i,n.drawImage(r,0,0,a,i);var c=n.getImageData(0,0,a,i);this.recolor({srcDataArray:Array.from(c.data),smallWidth:a,smallHeight:i,scale:o/a})}recolor({srcDataArray:r,scale:e=1,smallWidth:t,smallHeight:n}){var o=document.getElementById("target-canvas");o.width=t*e,o.height=n*e;for(var a=o.getContext("2d"),c={},l=0;l<r.length;l+=4){let n=r.slice(l,l+4),o=this.rgbaToString(n),u=c[o];u||(u=this.rgbaToString([i.roll(256),i.roll(256),i.roll(256),255]),c[o]=u);let s=l/4,f=s%t*e,p=~~(s/t)*e;a.fillStyle=u,a.fillRect(f,p,e,e)}}rgbaToString(r){return`rgba(${r.slice(0,3).map(this.roundColorRawValue.bind(this)).join(", ")}, ${r[3]/255})`}roundColorRawValue(r){return~~(r/this.quantizationFactor)*this.quantizationFactor}}!function(){window.onerror=n;const r=c.parse(window.location.hash.slice(1));new l(r).loadSourceImage()}()},{"handle-error-web":2,probable:3,qs:5}],2:[function(r,e,t){function n(r){if(r){console.error(r,r.stack);var e="";r.name&&(e+=r.name+": "),e+=r.message,r.stack&&(e+=" | "+r.stack.toString()),function(r){var e=document.getElementById("status-message");e.textContent=r,e.classList.remove("hidden")}(e)}}e.exports=n},{}],3:[function(r,e,t){function n(r){function e(r){return Math.floor(p()*r)}function t(r){function t(r){return function(r,e){e=+e;for(var t=0;t<r.length;++t){var n=r[t],o=n[0];if(e>=o[0]&&e<=o[1])return n[1]}}(n,r)}var n=r,o=n[n.length-1][0][1]-n[0][0][0]+1;return{outcomeAtIndex:t,roll:function(){var r=t(e(o));return"function"!=typeof r||"probable_rollOnTable"!==r.name&&"probable_pick"!==r.name?r:r()},length:o,getRangesAndOutcomesArray:function(){return n}}}function n(r){var e=[],t=-1,n=function(r){var e=[];for(var t in r){var n=r[t];e.push([n,t])}return e}(r);return(n=n.sort(o)).forEach(function(r){var n=r[0],o=r[1],a=t+1,i=a+n-1;e.push([[a,i],o]),t=i}),e}function o(r,e){return r[0]>e[0]?-1:1}function a(r){return t(function(r){var e=[];for(var t in r){var n=function(r){var e=r.split("-");if(e.length>2)return;return 1===e.length?[+r,+r]:[+e[0],+e[1]]}(t),o=r[t];if("object"==typeof o)if(Array.isArray(o))o=u(o);else{var c=a(o);"function"==typeof c.roll&&(o=c.roll)}e.push([n,o])}return e.sort(i)}(r))}function i(r,e){return r[0][0]<e[0][0]?-1:1}function c(r){return t(function(r){function e(r){var e=r[0],n=r[1],o=t+e-1,a=[t,o];if(t=o+1,Array.isArray(n))if(function(r){return Array.isArray(r)&&r.length>0&&Array.isArray(r[0])&&2===r[0].length&&"number"==typeof r[0][0]}(n)){var i=c(n);"function"==typeof i.roll&&(n=i.roll)}else n=u(n);return[a,n]}var t=0;return r.map(e)}(r))}function l(r,t){return!r||"number"!=typeof r.length||r.length<1?t:r[e(r.length)]}function u(r,e){return function(){return l(r,e)}}function s(r,e){var t=[];return r.forEach(function(r){e.forEach(function(e){Array.isArray(r)||Array.isArray(e)?t.push(r.concat(e)):t.push([r,e])})}),t}function f(r){for(var t,n=r.length,o=Array(n),a=0;a<n;a++)(t=e(a+1))!==a&&(o[a]=o[t]),o[t]=r[a];return o}var p=Math.random;return r&&r.random&&(p=r.random),{roll:e,rollDie:function(r){return 0===r?0:e(r)+1},createRangeTable:t,createRangeTableFromDict:function(r){return t(n(r))},createTableFromDef:a,createTableFromSizes:c,convertDictToRangesAndOutcomePairs:n,pickFromArray:l,crossArrays:s,getCartesianProduct:function(r){return r.slice(1).reduce(s,r[0])},shuffle:f,sample:function(r,e){return f(r).slice(0,e)},randomFn:p}}var o=n();"object"==typeof e&&(e.exports=o,e.exports.createProbable=n)},{}],4:[function(r,e,t){"use strict";var n=String.prototype.replace,o=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(r){return n.call(r,o,"+")},RFC3986:function(r){return r}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},{}],5:[function(r,e,t){"use strict";var n=r("./stringify"),o=r("./parse"),a=r("./formats");e.exports={formats:a,parse:o,stringify:n}},{"./formats":4,"./parse":6,"./stringify":7}],6:[function(r,e,t){"use strict";var n=r("./utils"),o=Object.prototype.hasOwnProperty,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:n.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},i=function(r,e,t){if(r){var n=t.allowDots?r.replace(/\.([^.[]+)/g,"[$1]"):r,a=/(\[[^[\]]*])/g,i=/(\[[^[\]]*])/.exec(n),c=i?n.slice(0,i.index):n,l=[];if(c){if(!t.plainObjects&&o.call(Object.prototype,c)&&!t.allowPrototypes)return;l.push(c)}for(var u=0;null!==(i=a.exec(n))&&u<t.depth;){if(u+=1,!t.plainObjects&&o.call(Object.prototype,i[1].slice(1,-1))&&!t.allowPrototypes)return;l.push(i[1])}return i&&l.push("["+n.slice(i.index)+"]"),function(r,e,t){for(var n=e,o=r.length-1;o>=0;--o){var a,i=r[o];if("[]"===i)a=(a=[]).concat(n);else{a=t.plainObjects?Object.create(null):{};var c="["===i.charAt(0)&&"]"===i.charAt(i.length-1)?i.slice(1,-1):i,l=parseInt(c,10);!isNaN(l)&&i!==c&&String(l)===c&&l>=0&&t.parseArrays&&l<=t.arrayLimit?(a=[])[l]=n:a[c]=n}n=a}return n}(l,e,t)}};e.exports=function(r,e){var t=e?n.assign({},e):{};if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(t.ignoreQueryPrefix=!0===t.ignoreQueryPrefix,t.delimiter="string"==typeof t.delimiter||n.isRegExp(t.delimiter)?t.delimiter:a.delimiter,t.depth="number"==typeof t.depth?t.depth:a.depth,t.arrayLimit="number"==typeof t.arrayLimit?t.arrayLimit:a.arrayLimit,t.parseArrays=!1!==t.parseArrays,t.decoder="function"==typeof t.decoder?t.decoder:a.decoder,t.allowDots="boolean"==typeof t.allowDots?t.allowDots:a.allowDots,t.plainObjects="boolean"==typeof t.plainObjects?t.plainObjects:a.plainObjects,t.allowPrototypes="boolean"==typeof t.allowPrototypes?t.allowPrototypes:a.allowPrototypes,t.parameterLimit="number"==typeof t.parameterLimit?t.parameterLimit:a.parameterLimit,t.strictNullHandling="boolean"==typeof t.strictNullHandling?t.strictNullHandling:a.strictNullHandling,""===r||null===r||void 0===r)return t.plainObjects?Object.create(null):{};for(var c="string"==typeof r?function(r,e){for(var t={},n=e.ignoreQueryPrefix?r.replace(/^\?/,""):r,i=e.parameterLimit===1/0?void 0:e.parameterLimit,c=n.split(e.delimiter,i),l=0;l<c.length;++l){var u,s,f=c[l],p=f.indexOf("]="),d=-1===p?f.indexOf("="):p+1;-1===d?(u=e.decoder(f,a.decoder),s=e.strictNullHandling?null:""):(u=e.decoder(f.slice(0,d),a.decoder),s=e.decoder(f.slice(d+1),a.decoder)),o.call(t,u)?t[u]=[].concat(t[u]).concat(s):t[u]=s}return t}(r,t):r,l=t.plainObjects?Object.create(null):{},u=Object.keys(c),s=0;s<u.length;++s){var f=u[s],p=i(f,c[f],t);l=n.merge(l,p,t)}return n.compact(l)}},{"./utils":8}],7:[function(r,e,t){"use strict";var n=r("./utils"),o=r("./formats"),a={brackets:function(r){return r+"[]"},indices:function(r,e){return r+"["+e+"]"},repeat:function(r){return r}},i=Date.prototype.toISOString,c={delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,serializeDate:function(r){return i.call(r)},skipNulls:!1,strictNullHandling:!1},l=function r(e,t,o,a,i,l,u,s,f,p,d,y){var g=e;if("function"==typeof u)g=u(t,g);else if(g instanceof Date)g=p(g);else if(null===g){if(a)return l&&!y?l(t,c.encoder):t;g=""}if("string"==typeof g||"number"==typeof g||"boolean"==typeof g||n.isBuffer(g)){if(l){return[d(y?t:l(t,c.encoder))+"="+d(l(g,c.encoder))]}return[d(t)+"="+d(String(g))]}var h=[];if(void 0===g)return h;var m;if(Array.isArray(u))m=u;else{var v=Object.keys(g);m=s?v.sort(s):v}for(var b=0;b<m.length;++b){var A=m[b];i&&null===g[A]||(h=Array.isArray(g)?h.concat(r(g[A],o(t,A),o,a,i,l,u,s,f,p,d,y)):h.concat(r(g[A],t+(f?"."+A:"["+A+"]"),o,a,i,l,u,s,f,p,d,y)))}return h};e.exports=function(r,e){var t=r,i=e?n.assign({},e):{};if(null!==i.encoder&&void 0!==i.encoder&&"function"!=typeof i.encoder)throw new TypeError("Encoder has to be a function.");var u=void 0===i.delimiter?c.delimiter:i.delimiter,s="boolean"==typeof i.strictNullHandling?i.strictNullHandling:c.strictNullHandling,f="boolean"==typeof i.skipNulls?i.skipNulls:c.skipNulls,p="boolean"==typeof i.encode?i.encode:c.encode,d="function"==typeof i.encoder?i.encoder:c.encoder,y="function"==typeof i.sort?i.sort:null,g=void 0!==i.allowDots&&i.allowDots,h="function"==typeof i.serializeDate?i.serializeDate:c.serializeDate,m="boolean"==typeof i.encodeValuesOnly?i.encodeValuesOnly:c.encodeValuesOnly;if(void 0===i.format)i.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,i.format))throw new TypeError("Unknown format option provided.");var v,b,A=o.formatters[i.format];"function"==typeof i.filter?t=(b=i.filter)("",t):Array.isArray(i.filter)&&(v=b=i.filter);var j=[];if("object"!=typeof t||null===t)return"";var O;O=i.arrayFormat in a?i.arrayFormat:"indices"in i?i.indices?"indices":"repeat":"indices";var w=a[O];v||(v=Object.keys(t)),y&&v.sort(y);for(var x=0;x<v.length;++x){var D=v[x];f&&null===t[D]||(j=j.concat(l(t[D],D,w,s,f,p?d:null,b,y,g,h,A,m)))}var C=j.join(u),F=!0===i.addQueryPrefix?"?":"";return C.length>0?F+C:""}},{"./formats":4,"./utils":8}],8:[function(r,e,t){"use strict";var n=Object.prototype.hasOwnProperty,o=function(){for(var r=[],e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r}(),a=function(r,e){for(var t=e&&e.plainObjects?Object.create(null):{},n=0;n<r.length;++n)void 0!==r[n]&&(t[n]=r[n]);return t};e.exports={arrayToObject:a,assign:function(r,e){return Object.keys(e).reduce(function(r,t){return r[t]=e[t],r},r)},compact:function(r){for(var e=[{obj:{o:r},prop:"o"}],t=[],n=0;n<e.length;++n)for(var o=e[n],a=o.obj[o.prop],i=Object.keys(a),c=0;c<i.length;++c){var l=i[c],u=a[l];"object"==typeof u&&null!==u&&-1===t.indexOf(u)&&(e.push({obj:a,prop:l}),t.push(u))}return function(r){for(var e;r.length;){var t=r.pop();if(e=t.obj[t.prop],Array.isArray(e)){for(var n=[],o=0;o<e.length;++o)void 0!==e[o]&&n.push(e[o]);t.obj[t.prop]=n}}return e}(e)},decode:function(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return r}},encode:function(r){if(0===r.length)return r;for(var e="string"==typeof r?r:String(r),t="",n=0;n<e.length;++n){var a=e.charCodeAt(n);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?t+=e.charAt(n):a<128?t+=o[a]:a<2048?t+=o[192|a>>6]+o[128|63&a]:a<55296||a>=57344?t+=o[224|a>>12]+o[128|a>>6&63]+o[128|63&a]:(n+=1,a=65536+((1023&a)<<10|1023&e.charCodeAt(n)),t+=o[240|a>>18]+o[128|a>>12&63]+o[128|a>>6&63]+o[128|63&a])}return t},isBuffer:function(r){return null!==r&&void 0!==r&&!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))},isRegExp:function(r){return"[object RegExp]"===Object.prototype.toString.call(r)},merge:function r(e,t,o){if(!t)return e;if("object"!=typeof t){if(Array.isArray(e))e.push(t);else{if("object"!=typeof e)return[e,t];(o.plainObjects||o.allowPrototypes||!n.call(Object.prototype,t))&&(e[t]=!0)}return e}if("object"!=typeof e)return[e].concat(t);var i=e;return Array.isArray(e)&&!Array.isArray(t)&&(i=a(e,o)),Array.isArray(e)&&Array.isArray(t)?(t.forEach(function(t,a){n.call(e,a)?e[a]&&"object"==typeof e[a]?e[a]=r(e[a],t,o):e.push(t):e[a]=t}),e):Object.keys(t).reduce(function(e,a){var i=t[a];return n.call(e,a)?e[a]=r(e[a],i,o):e[a]=i,e},i)}}},{}]},{},[1]);